<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>予約確認</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="p-6 bg-gray-50 text-gray-800">
  <div class="max-w-md mx-auto bg-white rounded-2xl shadow-lg p-6 text-center">
    <h2 class="text-xl font-bold mb-4">🎉 ご予約ありがとうございます！</h2>

    <div id="reservationDetails" class="text-left space-y-3"></div>

    <button id="closeBtn" class="mt-6 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg">
      LINEに戻る
    </button>
  </div>

  <script>
    // 📦 URLパラメータを取得
    const params = new URLSearchParams(window.location.search);

    const name = params.get("name") || "";
    const phone = params.get("phone") || "";
    const store = params.get("store") || "";
    const pickupDate = params.get("pickupDate") || "";
    const pickupTime = params.get("pickupTime") || "";
    const products = params.get("products") || "";
    const total = params.get("total") || "";
    const memo = params.get("memo") || "";

    // 🗓 日付を「〇年〇月〇日（曜）」に変換
    function formatJapaneseDate(isoDate) {
      if (!isoDate) return "";
      const date = new Date(isoDate + "T00:00:00");
      const days = ["日", "月", "火", "水", "木", "金", "土"];
      const y = date.getFullYear();
      const m = date.getMonth() + 1;
      const d = date.getDate();
      const w = days[date.getDay()];
      return `${y}年${m}月${d}日（${w}）`;
    }

    // ⏰ 時間を「〇時〇分」に変換
    function formatJapaneseTime(time) {
      if (!time) return "";
      const [h, m] = time.split(":");
      return `${parseInt(h)}時${m}分`;
    }

    // 🧾 HTMLに反映
    document.getElementById("reservationDetails").innerHTML = `
      <p><strong>お名前：</strong>${name}</p>
      <p><strong>電話番号：</strong>${phone}</p>
      <p><strong>受取店舗：</strong>${store}</p>
      <p><strong>受取日時：</strong>${formatJapaneseDate(pickupDate)} ${formatJapaneseTime(pickupTime)}</p>
      <p><strong>ご注文内容：</strong><br>${products.replace(/\n/g, "<br>")}</p>
      <p><strong>合計金額：</strong>${total}円</p>
      ${memo ? `<p><strong>備考：</strong>${memo}</p>` : ""}
    `;

    // ✅ LINEアプリへ戻る
    document.getElementById("closeBtn").addEventListener("click", () => {
      if (typeof liff !== "undefined" && liff.isInClient()) {
        liff.closeWindow();
      } else {
        window.location.href = "https://line.me/";
      }
    });
  </script>
</body>
</html>
